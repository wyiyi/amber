<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="è®°å½•ç‚¹ç‚¹æ»´æ»´"><title>åŸºäº MyBatis æ‹¦æˆªå™¨æœºåˆ¶å®ç°ä¸€ä¸ªæ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶ | Amber</title><link rel="stylesheet" type="text/css" href="/amber/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="/amber/css/dark.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/amber/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/amber/favicon.ico"><link rel="apple-touch-icon" href="/amber/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/amber/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/amber/atom.xml"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">åŸºäº MyBatis æ‹¦æˆªå™¨æœºåˆ¶å®ç°ä¸€ä¸ªæ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶</h1><a id="logo" href="/amber/.">Amber</a><p class="description">ä¸€å¤©è¿›æ­¥ä¸€ç‚¹</p></div><div id="nav-menu"><a class="current" href="/amber/."><i class="fa fa-home"> Home</i></a><a href="/amber/archives/"><i class="fa fa-archive"> Archive</i></a><a href="/amber/about/"><i class="fa fa-user"> About</i></a><a href="/amber/atom.xml"><i class="fa fa-rss"> RSS</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">åŸºäº MyBatis æ‹¦æˆªå™¨æœºåˆ¶å®ç°ä¸€ä¸ªæ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶</h1><div class="post-meta">2024-02-01<span> | </span><span class="category"><a href="/amber/categories/Technology/">Technology</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 3.9k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 18</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Contents</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å¼•è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Interceptor-%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">Interceptor ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Signature-%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.1.</span> <span class="toc-text">Signature ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Interceptor-%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.2.</span> <span class="toc-text">Interceptor æ¥å£</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Simple-Example"><span class="toc-number">2.3.</span> <span class="toc-text">Simple Example</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E7%BB%84%E4%BB%B6"><span class="toc-number">3.</span> <span class="toc-text">æ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%E6%8F%8F%E8%BF%B0"><span class="toc-number">3.1.</span> <span class="toc-text">åœºæ™¯æè¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">3.2.</span> <span class="toc-text">è®¾è®¡æ€è·¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.3.</span> <span class="toc-text">å‚è€ƒå®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8B%A6%E6%88%AA%E5%99%A8-DataSensitiveInterceptor"><span class="toc-number">3.3.1.</span> <span class="toc-text">è‡ªå®šä¹‰æ•æ„Ÿæ•°æ®å¤„ç†æ‹¦æˆªå™¨ DataSensitiveInterceptor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E7%B1%BB-DataSensitiveConfig"><span class="toc-number">3.3.2.</span> <span class="toc-text">é…ç½®ç±» DataSensitiveConfig</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%8E%A5%E5%8F%A3-DataSensitiveHandler"><span class="toc-number">3.3.3.</span> <span class="toc-text">æ•æ„Ÿæ•°æ®å¤„ç†æ¥å£ DataSensitiveHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.3.4.</span> <span class="toc-text">å†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-number">3.3.5.</span> <span class="toc-text">é…ç½®</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="toc-number">3.4.</span> <span class="toc-text">å•å…ƒæµ‹è¯•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">3.5.</span> <span class="toc-text">æ³¨æ„äº‹é¡¹</span></a></li></ol></li></ol></div></div><div class="post-content"><h1 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h1><p><code>MyBatis</code> ä½œä¸ºä¸€ä¸ªæµè¡Œçš„æŒä¹…å±‚æ¡†æ¶ï¼Œæä¾›äº†æ‹¦æˆªå™¨ <code>Interceptor</code> æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…åœ¨ <code>SQL</code> æ‰§è¡Œè¿‡ç¨‹ä¸­æ’å…¥è‡ªå®šä¹‰é€»è¾‘ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨ <code>MyBatis</code> æ‹¦æˆªå™¨çš„ç”¨æ³•å’Œä½¿ç”¨åœºæ™¯ï¼Œå¹¶ä»¥å¤„ç†æ•æ„Ÿæ•°æ®åœºæ™¯ä¸ºä¾‹å®ç°äº†ä¸€ä¸ªè‡ªå®šä¹‰æ‹¦æˆªå™¨ã€‚</p>
<h1 id="Interceptor-ä»‹ç»"><a href="#Interceptor-ä»‹ç»" class="headerlink" title="Interceptor ä»‹ç»"></a>Interceptor ä»‹ç»</h1><p><a target="_blank" rel="noopener" href="https://mybatis.org/mybatis-3/zh_CN/configuration.html#%E6%8F%92%E4%BB%B6%EF%BC%88plugins%EF%BC%89">MyBatis å®˜ç½‘ä¸­ Interceptor çš„ä»‹ç»ï¼š</a></p>
<blockquote>
<p>MyBatis å…è®¸ä½ åœ¨æ˜ å°„è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­çš„æŸä¸€ç‚¹è¿›è¡Œæ‹¦æˆªè°ƒç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒMyBatis å…è®¸ä½¿ç”¨æ’ä»¶æ¥æ‹¦æˆªçš„æ–¹æ³•è°ƒç”¨åŒ…æ‹¬ï¼š</p>
<ul>
<li>Executor (update, query, flushStatements, commit, rollback, getTransaction, close, isClosed)</li>
<li>ParameterHandler (getParameterObject, setParameters)</li>
<li>ResultSetHandler (handleResultSets, handleOutputParameters)</li>
<li>StatementHandler (prepare, parameterize, batch, update, query)</li>
</ul>
<p>é€šè¿‡ MyBatis æä¾›çš„å¼ºå¤§æœºåˆ¶ï¼Œä½¿ç”¨æ’ä»¶æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€å®ç° Interceptor æ¥å£ï¼Œå¹¶æŒ‡å®šæƒ³è¦æ‹¦æˆªçš„æ–¹æ³•ç­¾åå³å¯ã€‚</p>
</blockquote>
<h2 id="Signature-ä»‹ç»"><a href="#Signature-ä»‹ç»" class="headerlink" title="Signature ä»‹ç»"></a>Signature ä»‹ç»</h2><p>åœ¨ <a target="_blank" rel="noopener" href="https://book.douban.com/subject/27074809/">ã€ŠMyBatisä»å…¥é—¨åˆ°ç²¾é€šã€‹</a> ä¸€ä¹¦ä¸­ï¼Œå…³äºæ‹¦æˆªå™¨ç­¾å <code>@Signature</code> æ³¨è§£ä¸­å¯ä»¥ä½¿ç”¨çš„æ¥å£å’Œæ–¹æ³•ç›¸å…³æè¿°å¦‚ä¸‹ï¼š</p>
<ol>
<li><p><strong>Executor</strong>ï¼š</p>
<ul>
<li>update: å½“æ‰§è¡Œ INSERTã€UPDATEã€DELETE æ“ä½œæ—¶è°ƒç”¨ã€‚</li>
<li>query: åœ¨ SELECT æŸ¥è¯¢æ–¹æ³•æ‰§è¡Œæ—¶è°ƒç”¨ã€‚</li>
<li>flushStatements: åœ¨é€šè¿‡ SqlSession æ–¹æ³•è°ƒç”¨ flushStatements æ–¹æ³•æˆ–æ‰§è¡Œçš„æ¥å£æ–¹æ³•ä¸­å¸¦æœ‰ @Flush æ³¨è§£æ—¶æ‰è¢«è°ƒç”¨ã€‚</li>
<li>commit: åœ¨é€šè¿‡ SqlSession æ–¹æ³•è°ƒç”¨ commit æ–¹æ³•æ—¶è¢«è°ƒç”¨ã€‚</li>
<li>rollback: åœ¨é€šè¿‡ SqlSession æ–¹æ³•è°ƒç”¨ rollback æ–¹æ³•æ—¶è¢«è°ƒç”¨ã€‚</li>
<li>getTransaction: åœ¨é€šè¿‡ SqlSession æ–¹æ³•è·å–æ•°æ®åº“è¿æ¥æ—¶è¢«è°ƒç”¨ã€‚</li>
<li>close: åœ¨å»¶è¿ŸåŠ è½½è·å–æ–°çš„ Executor åæ‰ä¼šè¢«æ‰§è¡Œã€‚</li>
<li>isClosed: åœ¨å»¶è¿ŸåŠ è½½æ‰§è¡ŒæŸ¥è¯¢æ–¹æ³•å‰è¢«æ‰§è¡Œã€‚</li>
</ul>
</li>
<li><p><strong>ParameterHandler</strong>ï¼š</p>
<ul>
<li>getParameterObject: åœ¨æ‰§è¡Œå­˜å‚¨è¿‡ç¨‹å¤„ç†å‡ºå‚çš„æ—¶å€™è¢«è°ƒç”¨ã€‚</li>
<li>setParameters: åœ¨æ‰€æœ‰æ•°æ®åº“æ–¹æ³•è®¾ç½® SQL å‚æ•°æ—¶è¢«è°ƒç”¨ã€‚</li>
</ul>
</li>
<li><p><strong>ResultSetHandler</strong>ï¼š</p>
<ul>
<li>handleResultSets: å¤„ç†æŸ¥è¯¢ç»“æœé›†ã€‚</li>
<li>handleOutputParameters: ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹å¤„ç†å‡ºå‚æ—¶è¢«è°ƒç”¨ã€‚</li>
</ul>
</li>
<li><p><strong>StatementHandler</strong>ï¼š</p>
<ul>
<li>prepare: åœ¨æ•°æ®åº“æ‰§è¡Œå‰è¢«è°ƒç”¨ï¼Œä¼˜å…ˆäºå½“å‰æ¥å£ä¸­å…¶ä»–æ–¹æ³•è€Œè¢«æ‰§è¡Œã€‚</li>
<li>parameterize: åœ¨ prepare æ–¹æ³•åæ‰§è¡Œï¼Œç”¨äºå¤„ç†å‚æ•°ä¿¡æ¯ã€‚</li>
<li>batch: åœ¨å…¨å±€è®¾ç½®é…ç½® defaultExecutorType=â€BATCHâ€ æ—¶æ‰§è¡Œæ•°æ®æ“ä½œæ‰ä¼šè°ƒç”¨ã€‚</li>
<li>update: ç”¨äºæ‰§è¡Œæ›´æ–°ç±»å‹çš„ SQL è¯­å¥ã€‚</li>
<li>query: ç”¨äºè·å–æŸ¥è¯¢è¿”å›çš„ç»“æœé›†ã€‚</li>
</ul>
</li>
</ol>
<h2 id="Interceptor-æ¥å£"><a href="#Interceptor-æ¥å£" class="headerlink" title="Interceptor æ¥å£"></a>Interceptor æ¥å£</h2><p>é€šè¿‡å®ç° <code>Interceptor</code> æ¥å£å¹¶æŒ‡å®šæƒ³è¦æ‹¦æˆªçš„æ–¹æ³•ç­¾åï¼Œå¯ä»¥è½»æ¾åœ°å®ç°å¯¹ SQL æ‰§è¡Œè¿‡ç¨‹çš„æ‹¦æˆªã€‚<br><code>Interceptor</code> æ¥å£åŒ…å«ä»¥ä¸‹æ–¹æ³•ï¼šï¼ˆMybatis-3.5.1 ç‰ˆæœ¬ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable;</span><br><span class="line"></span><br><span class="line">    Object <span class="title function_">plugin</span><span class="params">(Object target)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>intercept(Invocation invocation)</code>: è¿™ä¸ªæ–¹æ³•ç”¨äºæ‹¦æˆªç›®æ ‡æ–¹æ³•å¹¶æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚è·å–ç›®æ ‡æ–¹æ³•çš„å‚æ•°ã€æ–¹æ³•ç­‰ä¿¡æ¯ï¼Œå¹¶è¿›è¡Œå¤„ç†ã€‚</li>
<li><code>plugin(Object target)</code>: è¿™ä¸ªæ–¹æ³•ç”¨äºç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡ã€‚éœ€è¦åˆ¤æ–­ç›®æ ‡å¯¹è±¡æ˜¯å¦éœ€è¦è¢«æ‹¦æˆªï¼Œå¦‚æœéœ€è¦åˆ™è¿”å›ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œå¦åˆ™è¿”å› nullã€‚</li>
<li><code>setProperties(Properties properties)</code>: è¿™ä¸ªæ–¹æ³•ç”¨äºè®¾ç½®å±æ€§ã€‚è·å–é…ç½®æ–‡ä»¶ä¸­çš„å±æ€§ï¼Œå¹¶è¿›è¡Œç›¸åº”çš„è®¾ç½®ã€‚</li>
</ul>
<p>åœ¨ <code>MyBatis</code> çš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œè‡ªå®šä¹‰ <code>Interceptor</code> åï¼Œæ¡†æ¶ä¼šåœ¨æ‰§è¡Œç›¸åº”çš„æ“ä½œæ—¶è‡ªåŠ¨è°ƒç”¨è‡ªå®šä¹‰é€»è¾‘ã€‚</p>
<h2 id="Simple-Example"><a href="#Simple-Example" class="headerlink" title="Simple Example"></a>Simple Example</h2><ol>
<li>åˆ›å»º <code>ExamplePlugin</code> ç±»å®ç° <code>org.apache.ibatis.plugin.Interceptor</code> æ¥å£ï¼š</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ExamplePlugin.java</span></span><br><span class="line"><span class="meta">@Intercepts(&#123;</span></span><br><span class="line"><span class="meta">   @Signature(type= Executor.class,</span></span><br><span class="line"><span class="meta">              method = &quot;update&quot;,</span></span><br><span class="line"><span class="meta">              args = &#123;MappedStatement.class,Object.class&#125;),</span></span><br><span class="line"><span class="meta">   @Signature(type = ResultSetHandler.class, </span></span><br><span class="line"><span class="meta">              method = &quot;handleResultSets&quot;, </span></span><br><span class="line"><span class="meta">              args = &#123;Statement.class&#125;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ExamplePlugin</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">    <span class="comment">// implement pre processing if need</span></span><br><span class="line">    <span class="type">Object</span> <span class="variable">returnObject</span> <span class="operator">=</span> invocation.proceed();</span><br><span class="line">    <span class="comment">// implement post processing if need</span></span><br><span class="line">    <span class="keyword">return</span> returnObject;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.properties = properties;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Tips</strong>ï¼šåœ¨ <a target="_blank" rel="noopener" href="https://github.com/mybatis/mybatis-3/blob/mybatis-3.5.2/src/main/java/org/apache/ibatis/plugin/Interceptor.java">Mybatis-3.5.2 ç‰ˆæœ¬å Interceptor</a> æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•å·²ç»™å‡ºäº†é»˜è®¤å®ç°ï¼Œå¦‚æ— ç‰¹æ®Šéœ€æ±‚ï¼Œåªéœ€å®ç° <code>intercept</code> æ–¹æ³•ï¼Œè¿™æ˜¯ <code>Java 8</code> é»˜è®¤æ–¹æ³•ç‰¹æ€§çš„ä¸€ç§åº”ç”¨ï¼Œæ—¨åœ¨ç®€åŒ–æ¥å£çš„å®ç°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">  Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">default</span> Object <span class="title function_">plugin</span><span class="params">(Object target)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> Plugin.wrap(target, <span class="built_in">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">default</span> <span class="keyword">void</span> <span class="title function_">setProperties</span><span class="params">(Properties properties)</span> &#123;</span><br><span class="line">    <span class="comment">// NOP</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>åœ¨ <code>MyBatis</code> çš„é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ <code>ExamplePlugin</code>ï¼š</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- mybatis-config.xml --&gt;</span><br><span class="line">&lt;plugins&gt;</span><br><span class="line">  &lt;plugin interceptor=&quot;org.mybatis.example.ExamplePlugin&quot;&gt;</span><br><span class="line">    &lt;property name=&quot;someProperty&quot; value=&quot;100&quot;/&gt;</span><br><span class="line">  &lt;/plugin&gt;</span><br><span class="line">&lt;/plugins&gt;</span><br></pre></td></tr></table></figure>

<h1 id="æ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶"><a href="#æ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶" class="headerlink" title="æ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶"></a>æ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶</h1><h2 id="åœºæ™¯æè¿°"><a href="#åœºæ™¯æè¿°" class="headerlink" title="åœºæ™¯æè¿°"></a>åœºæ™¯æè¿°</h2><p>åœ¨æŒä¹…åŒ–çš„æ•°æ®æ¶‰åŠæ•æ„Ÿå†…å®¹æ—¶ï¼Œå‡è®¾æœ‰å¦‚ä¸‹ä¸‰ç§åœºæ™¯ï¼š</p>
<ol>
<li>ä¸ºé¿å…æ‹–åº“é€ æˆçš„æ•°æ®æ³„éœ²é£é™©ï¼Œæ•æ„Ÿæ•°æ®å¸Œæœ›ä»¥å¯†æ–‡å½¢å¼å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œé€šè¿‡ç³»ç»Ÿè¯»å–æ—¶å¯ä»¥è¯»å–åˆ°æ˜æ–‡ï¼›</li>
<li>å¯†ç ç±»æ•°æ®åœ¨å­˜å‚¨å‰å¸Œæœ›è¿›è¡Œä¸å¯é€†çš„åŠ å¯†å¤„ç†ï¼Œè¯»å–æ—¶ä¹Ÿæ˜¯ä½¿ç”¨å¯†æ–‡è¿›è¡Œå¯¹æ¯”ï¼Œæ— éœ€æ¢å¤å‡ºæ˜æ–‡å†…å®¹ï¼›</li>
<li>å±•ç¤ºå¦‚æ‰‹æœºå·ç­‰æ•°æ®æ—¶ï¼Œå¸Œæœ›å¯¹éƒ¨åˆ†å†…å®¹è¿›è¡Œé®æŒ¡ï¼Œä½¿æ•°æ®ä»…ä¿ç•™æ ¸å¯¹ç”¨é€”ã€‚</li>
</ol>
<h2 id="è®¾è®¡æ€è·¯"><a href="#è®¾è®¡æ€è·¯" class="headerlink" title="è®¾è®¡æ€è·¯"></a>è®¾è®¡æ€è·¯</h2><p>ä¸Šé¢å‡è®¾çš„ä¸‰ç§åœºæ™¯å¯ä»¥åˆ†ä¸ºæ•°æ®çš„ <code>è¯»å–</code> å’Œ <code>å†™å…¥</code> ä¸¤ç±»æ“ä½œï¼š</p>
<ul>
<li>åœºæ™¯ 1 éœ€è¦åœ¨æ•°æ®å†™å…¥æ—¶åŠ å¯†ï¼Œè¯»å–æ•°æ®æ—¶è§£å¯†ï¼›</li>
<li>åœºæ™¯ 2 åœ¨æ•°æ®å†™å…¥æ—¶åŠ å¯†ï¼Œè¯»å–æ—¶æ— éœ€å¤„ç†ï¼›</li>
<li>åœºæ™¯ 3 åœ¨æ•°æ®è¯»å–æ—¶è¿›è¡Œé®æŒ¡ï¼Œå†™å…¥æ—¶æ— éœ€å¤„ç†ã€‚</li>
</ul>
<p><code>MyBatis</code> çš„æ‹¦æˆªå™¨ç­¾åä¸­ï¼Œå¯ä»¥é€‰æ‹© <code>Executor</code> çš„ <code>update</code> æ–¹æ³•æ‹¦æˆª <code>å†™å…¥</code> åŠ¨ä½œï¼Œ<code>ResultSetHandler</code> çš„ <code>handleResultSets</code> æ–¹æ³•æ‹¦æˆª <code>è¯»å–</code> åŠ¨ä½œã€‚</p>
<p>ä¸ºæ»¡è¶³ä¸åŒç±»å‹çš„æ•æ„Ÿæ•°æ®å¤„ç†éœ€æ±‚ï¼Œè®¾è®¡ä¸€ä¸ª <code>DataSensitiveHandler</code> æ¥å£ï¼Œæ¥å£ä¸­åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<ul>
<li><code>encrypt</code>ï¼šå®ç°å†™å…¥æ•°æ®å‰è¦æ‰§è¡Œçš„æ“ä½œ</li>
<li><code>decrypt</code>ï¼šå®ç°è¯»å–æ•°æ®åï¼ˆè¿”å›æ•°æ®å‰ï¼‰è¦æ‰§è¡Œçš„æ“ä½œ</li>
</ul>
<p>å¯ä»¥æ³¨å†Œä¸åŒçš„ <code>DataSensitiveHandler</code> å®ç°ç±»ï¼Œå¹¶ä¸ºå®ä½“ä¸­çš„å±æ€§ï¼ˆè¡¨ä¸­å­—æ®µï¼‰é…ç½®ä½¿ç”¨å“ªä¸ªå®ç°è¿›è¡Œæ•æ„Ÿæ•°æ®çš„å¤„ç†ã€‚</p>
<p>ä¸ºäº†å°½å¯èƒ½å°‘åœ°ä¿®æ”¹åŸæœ‰ä»£ç ï¼Œä»¥ç»Ÿä¸€çš„é…ç½®æ–¹å¼å®ç°å±æ€§ï¼ˆå­—æ®µï¼‰å’Œå¤„ç†ç±»çš„æ˜ å°„ã€‚</p>
<p>å…·ä½“é…ç½®å½¢å¼å‚è€ƒæ—¥å¿—çº§åˆ«é…ç½®æ–¹å¼ï¼ˆå¦‚ï¼š<code>logging.level.com.example.demo.mapper=debug</code>ï¼‰ï¼Œ<br>ä»¥ <code>å›ºå®šå‰ç¼€</code>.<code>å®ä½“package.å®ä½“å.å±æ€§å</code> = <code>å…·ä½“å¤„ç†ç±»å”¯ä¸€æ ‡è¯†</code> è¿›è¡Œè®¾ç½®ã€‚</p>
<h2 id="å‚è€ƒå®ç°"><a href="#å‚è€ƒå®ç°" class="headerlink" title="å‚è€ƒå®ç°"></a>å‚è€ƒå®ç°</h2><h3 id="è‡ªå®šä¹‰æ•æ„Ÿæ•°æ®å¤„ç†æ‹¦æˆªå™¨-DataSensitiveInterceptor"><a href="#è‡ªå®šä¹‰æ•æ„Ÿæ•°æ®å¤„ç†æ‹¦æˆªå™¨-DataSensitiveInterceptor" class="headerlink" title="è‡ªå®šä¹‰æ•æ„Ÿæ•°æ®å¤„ç†æ‹¦æˆªå™¨ DataSensitiveInterceptor"></a>è‡ªå®šä¹‰æ•æ„Ÿæ•°æ®å¤„ç†æ‹¦æˆªå™¨ <code>DataSensitiveInterceptor</code></h3><p>åœ¨ <code>intercept</code> æ–¹æ³•ä¸­æ ¹æ®é…ç½®æ‰¾åˆ°éœ€è¦å¤„ç†çš„å±æ€§çš„å¤„ç†ç±»ï¼ˆ<code>dataSensitiveHandler-</code> ä¸ºå‰ç¼€çš„ <code>Bean</code>ï¼‰ï¼Œå¹¶æ ¹æ®æ‹¦æˆªçš„å†™å…¥å’Œè¯»å–æ“ä½œè°ƒç”¨å¯¹åº”å¤„ç†æ–¹æ³•ï¼Œä»¥å®ç°æ•æ„Ÿæ•°æ®å¤„ç†çš„è¦æ±‚ï¼ˆå¦‚ä¸­é—´éƒ¨åˆ†ç”¨*ä»£æ›¿ã€æ˜¾ç¤ºå¯†æ–‡å¤„ç†åçš„ç»“æœç­‰ï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Intercepts(&#123;</span></span><br><span class="line"><span class="meta">        @Signature(type = Executor.class, method = &quot;update&quot;, args = &#123;MappedStatement.class, Object.class&#125;),</span></span><br><span class="line"><span class="meta">        @Signature(type = ResultSetHandler.class, method = &quot;handleResultSets&quot;, args = &#123;Statement.class&#125;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSensitiveInterceptor</span> <span class="keyword">implements</span> <span class="title class_">Interceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, String&gt; configs;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * è·å–é…ç½®æ–‡ä»¶ä¸­éœ€è¦åŠ å¯†çš„å±æ€§</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> config DataSensitiveConfig</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">public</span> <span class="title function_">DataSensitiveInterceptor</span><span class="params">(DataSensitiveConfig config)</span> &#123;</span><br><span class="line">      <span class="built_in">this</span>.configs = config.getSensitive();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * é€šè¿‡æ‹¦æˆªå™¨å¤„ç†</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> invocation invocation</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> Object</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@throws</span> Throwable å¼‚å¸¸</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> Object <span class="title function_">intercept</span><span class="params">(Invocation invocation)</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">      <span class="keyword">if</span> (invocation.getTarget() <span class="keyword">instanceof</span> Executor) &#123;</span><br><span class="line">         <span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> invocation.getArgs()[<span class="number">1</span>];</span><br><span class="line">         <span class="keyword">if</span> (object <span class="keyword">instanceof</span> Map) &#123;</span><br><span class="line">            Map&lt;String, Object&gt; map = (Map&lt;String, Object&gt;) object;</span><br><span class="line">            <span class="keyword">for</span> (Map.Entry&lt;String, Object&gt; entry : map.entrySet()) &#123;</span><br><span class="line">               <span class="keyword">if</span> (!entry.getKey().startsWith(<span class="string">&quot;param&quot;</span>)) &#123;</span><br><span class="line">                  handleEncrypt(entry.getValue());</span><br><span class="line">               &#125;</span><br><span class="line">               <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">         &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            handleEncrypt(object);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (invocation.getTarget() <span class="keyword">instanceof</span> ResultSetHandler) &#123;</span><br><span class="line">         <span class="type">ResultSetHandler</span> <span class="variable">resultSetHandler</span> <span class="operator">=</span> (ResultSetHandler) invocation.getTarget();</span><br><span class="line">         <span class="type">Statement</span> <span class="variable">statement</span> <span class="operator">=</span> (Statement) invocation.getArgs()[<span class="number">0</span>];</span><br><span class="line">         List&lt;Object&gt; resultList = resultSetHandler.handleResultSets(statement);</span><br><span class="line">         resultList.forEach(<span class="built_in">this</span>::handleDecrypt);</span><br><span class="line">         <span class="keyword">return</span> resultList;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> invocation.proceed();</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">handleEncrypt</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">      handleObject(object, <span class="literal">true</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">handleDecrypt</span><span class="params">(Object object)</span> &#123;</span><br><span class="line">      handleObject(object, <span class="literal">false</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">handleObject</span><span class="params">(Object object, <span class="type">boolean</span> encrypt)</span> &#123;</span><br><span class="line">      <span class="keyword">for</span> (Map.Entry&lt;String, String&gt; config : configs.entrySet()) &#123;</span><br><span class="line">         <span class="type">int</span> <span class="variable">lastPoint</span> <span class="operator">=</span> config.getKey().lastIndexOf(<span class="string">&#x27;.&#x27;</span>);</span><br><span class="line">         <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> config.getKey().substring(<span class="number">0</span>, lastPoint);</span><br><span class="line">         <span class="keyword">if</span> (object.getClass().getName().equals(className)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">property</span> <span class="operator">=</span> config.getKey().substring(lastPoint + <span class="number">1</span>);</span><br><span class="line">            <span class="type">String</span> <span class="variable">handlerName</span> <span class="operator">=</span> config.getValue();</span><br><span class="line">            <span class="type">DataSensitiveHandler</span> <span class="variable">handler</span> <span class="operator">=</span> SpringContextHolder.getBean(<span class="string">&quot;dataSensitiveHandler-&quot;</span> + handlerName);</span><br><span class="line">            <span class="type">BeanWrapper</span> <span class="variable">wrapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BeanWrapperImpl</span>(object);</span><br><span class="line">            wrapper.setPropertyValue(property,</span><br><span class="line">                    wrapper.getPropertyValue(property) == <span class="literal">null</span> ? <span class="literal">null</span> :</span><br><span class="line">                            encrypt ? handler.encrypt(String.valueOf(wrapper.getPropertyValue(property))) :</span><br><span class="line">                                    handler.decrypt(String.valueOf(wrapper.getPropertyValue(property)))</span><br><span class="line">            );</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®ç±»-DataSensitiveConfig"><a href="#é…ç½®ç±»-DataSensitiveConfig" class="headerlink" title="é…ç½®ç±» DataSensitiveConfig"></a>é…ç½®ç±» <code>DataSensitiveConfig</code></h3><p>é…ç½®å‚æ•°ä»¥å‰ç¼€ <code>com.amber.common.sensitive</code> å¼€å¤´ï¼Œä»¥ Map å½¢å¼å­˜å‚¨ç›¸å…³å‚æ•°é…ç½®ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><code>key</code> è®¾ç½®ä¸º MyBatis Mapper å®ä½“ç±»å…¨ååŠè¦å¤„ç†æ•æ„Ÿæ•°æ®çš„å±æ€§ï¼Œå¦‚ <code>UserDO</code> çš„ <code>phone</code> å±æ€§è®¾ç½®ä¸ºï¼š<code>com.amber.common.sensitive.mock.entity.UserDO.phone</code></li>
<li><code>value</code> è®¾ç½®ä¸ºæ•æ„Ÿæ•°æ®å¤„ç†ç±» <code>bean name</code> çš„åç¼€ï¼ŒæŸ¥æ‰¾ bean æ—¶åŠ ä¸Š <code>dataSensitiveHandler-</code> å‰ç¼€ç»„æˆå®Œæ•´ <code>bean name</code></li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(&quot;com.amber.common&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSensitiveConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, String&gt; sensitive = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, String&gt; <span class="title function_">getSensitive</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sensitive;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•æ„Ÿæ•°æ®å¤„ç†æ¥å£-DataSensitiveHandler"><a href="#æ•æ„Ÿæ•°æ®å¤„ç†æ¥å£-DataSensitiveHandler" class="headerlink" title="æ•æ„Ÿæ•°æ®å¤„ç†æ¥å£ DataSensitiveHandler"></a>æ•æ„Ÿæ•°æ®å¤„ç†æ¥å£ <code>DataSensitiveHandler</code></h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DataSensitiveHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * åœ¨å†™å…¥æ•°æ®æ—¶å¯¹æ•°æ®åšçš„å¤„ç†</span></span><br><span class="line"><span class="comment">    * é»˜è®¤ä¸ºä¸è¿›è¡Œä»»ä½•æ“ä½œ</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> str å°†è¦å†™å…¥çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> å®é™…å†™å…¥çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">default</span> String <span class="title function_">encrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * åœ¨è¯»å–æ•°æ®æ—¶å¯¹æ•°æ®åšçš„å¤„ç†</span></span><br><span class="line"><span class="comment">    * é»˜è®¤ä¸ºä¸è¿›è¡Œä»»ä½•æ“ä½œ</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> str å®é™…è¯»åˆ°çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> è¿”å›ç»™è°ƒç”¨è€…çš„æ•°æ®</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">default</span> String <span class="title function_">decrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> str;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°"><a href="#å†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°" class="headerlink" title="å†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°"></a>å†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°</h3><p>ä¸ºæ¯ç±»åœºæ™¯æä¾›ä¸€ä¸ªå†…ç½®æ•æ„Ÿæ•°æ®å¤„ç†å®ç°ï¼š</p>
<ul>
<li><code>abb</code>ï¼šå¯¹å­—ç¬¦ä¸²ä¸­é—´éƒ¨åˆ†ä½¿ç”¨ <code>*</code> é®æŒ¡ï¼Œä»…åœ¨è¯»å–æ•°æ®æ—¶æ‰§è¡Œæ“ä½œ</li>
<li><code>md5</code>ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œ md5 æ‘˜è¦ï¼Œä»…åœ¨å†™å…¥æ•°æ®æ—¶æ‰§è¡Œæ“ä½œ</li>
<li><code>sm4hex</code>ï¼šä½¿ç”¨å›½å¯† SM4 ç®—æ³•è¿›è¡Œå¯¹ç§°åŠ è§£å¯†ï¼Œä»¥ 16 è¿›åˆ¶è¡¨ç¤ºåŠ å¯†ç»“æœï¼Œåœ¨å†™å…¥åŠè¯»å–æ—¶å‡æ‰§è¡Œ</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ•æ„Ÿæ•°æ®å¤„ç†å™¨ï¼šä½¿ç”¨ * é®æŒ¡æ˜æ–‡ä¸­é—´éƒ¨åˆ†ï¼Œä¿ç•™å‰åå†…å®¹ã€‚</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ä»…åœ¨è¯»å–æ˜æ–‡æ•°æ®å¹¶è¿”å›æ—¶ï¼Œè¿›è¡Œé®æŒ¡å¤„ç†ï¼›</span></span><br><span class="line"><span class="comment"> * å­˜å…¥æ˜æ–‡æ•°æ®æ—¶ï¼Œä¸å¯¹å­˜å…¥å†…å®¹è¿›è¡Œå˜æ›´ã€‚</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * é®æŒ¡æ–¹å¼ä¸ºï¼š&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 1. æ˜æ–‡é•¿åº¦ä¸º 1 æ—¶ï¼Œä¸é®æŒ¡&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 2. æ˜æ–‡é•¿åº¦ä¸º 2 æ—¶ï¼Œé®æŒ¡ç¬¬äºŒä½&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 3. æ˜æ–‡é•¿åº¦å¤§äº 2 æ—¶ï¼Œå°†æ˜æ–‡åˆ†æˆä¸‰éƒ¨åˆ†ï¼Œé®æŒ¡ä¸­é—´éƒ¨åˆ†ï¼›ä¸èƒ½æ•´é™¤æ—¶ï¼Œå°½å¯èƒ½ä½¿é®æŒ¡éƒ¨åˆ†è¾ƒå¤š&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * é®æŒ¡åå†…å®¹é•¿åº¦ä¸æ˜æ–‡ä¿æŒä¸€è‡´ã€‚</span></span><br><span class="line"><span class="comment"> * å¦‚ï¼š&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ˜æ–‡                   | é®æŒ¡å&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;a&#x27;                   | &#x27;a&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;ab&#x27;                  | &#x27;a*&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;abc&#x27;                 | &#x27;a*c&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;abcd&#x27;                | &#x27;a**d&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;13012345678&#x27;         | &#x27;130*****678&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;123456789012345678&#x27;  | &#x27;123456******345678&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * &#x27;è¿™æ˜¯ä¸€æ®µæµ‹è¯•æ–‡å­—&#x27;       | &#x27;è¿™æ˜¯****æ–‡å­—&#x27;&lt;p&gt;</span></span><br><span class="line"><span class="comment"> * æ³¨å†Œ bean ä½¿ç”¨ â€dataSensitiveHandler-â€œ å›ºå®šå‰ç¼€ï¼Œabb ä¸ºåç¼€ï¼Œæ„ä¸º abbreviation</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(&quot;dataSensitiveHandler-abb&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSensitiveAbbHandler</span> <span class="keyword">implements</span> <span class="title class_">DataSensitiveHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">char</span> <span class="variable">MASK</span> <span class="operator">=</span> <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * å®ç°è§£å¯†æ–¹æ³•ï¼Œå¯¹å­—ç¬¦ä¸²ä¸­é—´éƒ¨åˆ†ä½¿ç”¨ `*` é®æŒ¡</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> str str</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> String</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">decrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (StringUtils.isBlank(str)) &#123;</span><br><span class="line">         <span class="keyword">return</span> str;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="type">int</span> <span class="variable">len</span> <span class="operator">=</span> str.length();</span><br><span class="line">      <span class="keyword">switch</span> (len) &#123;</span><br><span class="line">         <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> str;</span><br><span class="line">         <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> str.substring(<span class="number">0</span>, <span class="number">1</span>) + MASK;</span><br><span class="line">         <span class="keyword">default</span>:</span><br><span class="line">            <span class="type">int</span> <span class="variable">oriLen</span> <span class="operator">=</span> len / <span class="number">3</span>;</span><br><span class="line">            <span class="type">int</span> <span class="variable">maskLen</span> <span class="operator">=</span> len - oriLen * <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">return</span> str.substring(<span class="number">0</span>, oriLen) +</span><br><span class="line">                    StringUtils.repeat(MASK, maskLen) +</span><br><span class="line">                    str.substring(oriLen + maskLen);</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¤„ç†å™¨æ³¨å†Œ beanï¼Œâ€dataSensitiveHandler-â€œ ä¸ºå›ºå®šå‰ç¼€</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰åç¼€ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œ md5 æ‘˜è¦ï¼Œä»…åœ¨å†™å…¥æ•°æ®æ—¶æ‰§è¡Œæ“ä½œ</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Component(&quot;dataSensitiveHandler-md5&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSensitiveMd5Handler</span> <span class="keyword">implements</span> <span class="title class_">DataSensitiveHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">encrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> DigestUtils.md5Hex(str);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¤„ç†å™¨æ³¨å†Œ beanï¼Œâ€dataSensitiveHandler-â€œ ä¸ºå›ºå®šå‰ç¼€</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰åç¼€ï¼šsm4 ä½¿ç”¨å›½å¯† SM4 ç®—æ³•è¿›è¡Œå¯¹ç§°åŠ è§£å¯†ï¼Œåœ¨å†™å…¥åŠè¯»å–æ—¶å‡æ‰§è¡Œ</span></span><br><span class="line"><span class="comment"> * æ¡ä»¶æ³¨å†Œ Bean</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(name = &#123;&quot;org.bouncycastle.crypto.Digest&quot;, &quot;org.bouncycastle.asn1.gm.GMNamedCurves&quot;&#125;)</span></span><br><span class="line"><span class="meta">@Component(&quot;dataSensitiveHandler-sm4hex&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataSensitiveSm4HexHandler</span> <span class="keyword">implements</span> <span class="title class_">DataSensitiveHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">SymmetricCrypto</span> <span class="variable">SM4</span> <span class="operator">=</span> SmUtil.sm4();</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ä½¿ç”¨å›½å¯† SM4 ç®—æ³•è¿›è¡ŒåŠ å¯†</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> str æ˜æ–‡</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> å¯†æ–‡ 16 è¿›åˆ¶è¡¨ç¤º</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">encrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> SM4.encryptHex(str);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ä½¿ç”¨å›½å¯† SM4 ç®—æ³•è¿›è¡Œè§£å¯†</span></span><br><span class="line"><span class="comment">    *</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@param</span> str å¯†æ–‡</span></span><br><span class="line"><span class="comment">    * <span class="doctag">@return</span> æ˜æ–‡</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> String <span class="title function_">decrypt</span><span class="params">(String str)</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> SM4.decryptStr(str, CharsetUtil.CHARSET_UTF_8);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éœ€è¦å…¶ä»–ç±»å‹çš„å¤„ç†ç±»æ—¶ï¼Œæ³¨å†Œä¸€ä¸ªå®ç°äº† <code>DataSensitiveHandler</code> çš„ bean å³å¯ã€‚</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>æ”¯æŒ <code>yml</code> å’Œ <code>properties</code> æ–‡ä»¶æ ¼å¼ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">com:</span></span><br><span class="line">  <span class="attr">amber:</span></span><br><span class="line">    <span class="attr">common:</span></span><br><span class="line">      <span class="attr">sensitive:</span></span><br><span class="line">        <span class="attr">com.amber.common.sensitive.mock.entity.UserDO.phone:</span> <span class="string">abb</span></span><br><span class="line">        <span class="attr">com.amber.common.sensitive.mock.entity.UserDO.idCard:</span> <span class="string">sm4hex</span></span><br></pre></td></tr></table></figure>

<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">com.amber.common.sensitive.com.amber.common.sensitive.mock.entity.UserDO.password</span>=<span class="string">md5</span></span><br></pre></td></tr></table></figure>

<h2 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h2><ul>
<li>åŠ å¯†å’Œè§£å¯†ï¼šç¡®ä¿æ•æ„Ÿæ•°æ®åœ¨å†™å…¥æ•°æ®åº“æ—¶è¢«æ­£ç¡®åŠ å¯†ï¼Œå¹¶åœ¨ä»æ•°æ®åº“è¯»å–æ—¶è¢«æ­£ç¡®è§£å¯†ã€‚</li>
<li>é…ç½®è§£æï¼šéªŒè¯é…ç½®æ–‡ä»¶ä¸­çš„æ•æ„Ÿå­—æ®µæ˜¯å¦æ­£ç¡®åœ°è¢«è§£æå¹¶åº”ç”¨åˆ°æ‹¦æˆªå™¨ä¸­ã€‚</li>
<li>ä¸åŒå¤„ç†å™¨çš„åº”ç”¨ï¼šæµ‹è¯•ä¸åŒçš„æ•æ„Ÿæ•°æ®å¤„ç†å™¨ï¼ˆå¦‚ abbã€md5ã€sm4ï¼‰æ˜¯å¦æŒ‰ç…§é¢„æœŸå·¥ä½œã€‚</li>
<li>éæ•æ„Ÿå­—æ®µçš„ä¸å¤„ç†ï¼šç¡®ä¿éæ•æ„Ÿå­—æ®µåœ¨æ‹¦æˆªå™¨ä¸­ä¸è¢«é”™è¯¯åœ°å¤„ç†ã€‚</li>
</ul>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Sql</span></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DataSensitiveTest</span> <span class="keyword">extends</span> <span class="title class_">BaseApplicationTests</span> &#123;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   UserDAO userDAO</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   RoleDAO roleDAO</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   UserService userService</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   RoleService roleService</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   UserRoleService userRoleService</span><br><span class="line">   </span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   UserHistoryService userHistoryService</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   JdbcTemplate jdbcTemplate</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="keyword">static</span> <span class="keyword">final</span> MD5_LEN = <span class="number">32</span></span><br><span class="line">   <span class="keyword">def</span> name = <span class="string">&#x27;user name&#x27;</span></span><br><span class="line">   <span class="keyword">def</span> phone = <span class="string">&#x27;12345678901&#x27;</span></span><br><span class="line">   <span class="keyword">def</span> idCard = <span class="string">&#x27;234098uzxcv&#x27;</span></span><br><span class="line">   <span class="keyword">def</span> pwd = <span class="string">&#x27;123456&#x27;</span></span><br><span class="line"></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="type">void</span> cruTest() &#123;</span><br><span class="line">      <span class="keyword">def</span> user = testCreate()</span><br><span class="line">      <span class="keyword">def</span> retrievedUser = testRetrieve(user.getId())</span><br><span class="line">      testUpdate(retrievedUser)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testCreate() &#123;</span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select count(*) from userinfo&#x27;</span>, Integer) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">      UserDO user = <span class="keyword">new</span> UserDO()</span><br><span class="line">      user.setName(name)</span><br><span class="line">      user.setPhone(phone)</span><br><span class="line">      user.setIdCard(idCard)</span><br><span class="line">      user.setPassword(pwd)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> userDAO.insert(user) == <span class="number">1</span></span><br><span class="line">      <span class="keyword">assert</span> user.getId() &gt; <span class="string">&#x27;&#x27;</span></span><br><span class="line">      <span class="comment">// abb handler</span></span><br><span class="line">      <span class="keyword">assert</span> user.getPhone() == phone</span><br><span class="line">      <span class="comment">// md5 handler</span></span><br><span class="line">      <span class="keyword">assert</span> user.getPassword().length() == MD5_LEN</span><br><span class="line">      <span class="comment">// sm4hex handler</span></span><br><span class="line">      <span class="keyword">assert</span> user.getIdCard() != idCard &amp;&amp; user.getIdCard().length() == getSm4HexLen(idCard)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select count(*) from userinfo&#x27;</span>, Integer) == <span class="number">1</span></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select phone from userinfo&#x27;</span>, String) == phone</span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select password from userinfo&#x27;</span>, String).length() == MD5_LEN</span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select id_card from userinfo&#x27;</span>, String) != <span class="string">&#x27;234098uzxcv&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select id_card from userinfo&#x27;</span>, String).length() == getSm4HexLen(idCard)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> user</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">static</span> <span class="type">int</span> getSm4HexLen(String str) &#123;</span><br><span class="line">      <span class="comment">// SM4ç®—æ³•çš„å—å¤§å°ä¸º16å­—èŠ‚</span></span><br><span class="line">      <span class="type">int</span> blockSize = <span class="number">16</span></span><br><span class="line">      str &gt; <span class="string">&#x27;&#x27;</span> ?</span><br><span class="line">              ((int) (str.getBytes(StandardCharsets.UTF_8).length / blockSize) + <span class="number">1</span>) * blockSize * <span class="number">2</span> :</span><br><span class="line">              <span class="number">0</span></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testRetrieve(String userId) &#123;</span><br><span class="line">      UserDO retrievedUser = userDAO.selectById(userId)</span><br><span class="line">      <span class="keyword">assert</span> retrievedUser.getPhone() != phone</span><br><span class="line">      <span class="keyword">assert</span> retrievedUser.getPhone() == <span class="string">&#x27;123*****901&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUser.getIdCard() == idCard</span><br><span class="line">      <span class="keyword">return</span> retrievedUser</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testUpdate(UserDO userToUpdate) &#123;</span><br><span class="line">      <span class="keyword">def</span> newPhone = <span class="string">&#x27;01234567890&#x27;</span></span><br><span class="line">      <span class="keyword">def</span> newIdCard = <span class="string">&#x27;12345678901234567&#x27;</span></span><br><span class="line"></span><br><span class="line">      userToUpdate.setPhone(newPhone)</span><br><span class="line">      userToUpdate.setIdCard(newIdCard)</span><br><span class="line">      userDAO.updateById(userToUpdate)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> userToUpdate.getPhone() == newPhone</span><br><span class="line">      <span class="keyword">assert</span> userToUpdate.getIdCard() != newIdCard</span><br><span class="line">      <span class="keyword">assert</span> userToUpdate.getIdCard().length() == getSm4HexLen(newIdCard)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select phone from userinfo&#x27;</span>, String) == newPhone</span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select id_card from userinfo&#x27;</span>, String) != newIdCard</span><br><span class="line"></span><br><span class="line">      <span class="keyword">def</span> retrievedUser = userDAO.selectById(userToUpdate.getId())</span><br><span class="line">      <span class="keyword">assert</span> retrievedUser.getPhone() == <span class="string">&#x27;012*****890&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUser.getIdCard() == newIdCard</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Test</span></span><br><span class="line">   <span class="type">void</span> batchTest() &#123;</span><br><span class="line">      testBatchInsert()</span><br><span class="line">      List&lt;UserDO&gt; retrievedUsers = testBatchRetrieve()</span><br><span class="line">      testBatchUpdate(retrievedUsers)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testBatchInsert() &#123;</span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select count(*) from userinfo&#x27;</span>, Integer) == <span class="number">0</span></span><br><span class="line"></span><br><span class="line">      List&lt;UserDO&gt; users = <span class="keyword">new</span> ArrayList&lt;&gt;()</span><br><span class="line">      <span class="number">3.</span>times &#123;</span><br><span class="line">         UserDO user = <span class="keyword">new</span> UserDO()</span><br><span class="line">         user.setName(<span class="string">&quot;$&#123;name&#125;$&#123;it+1&#125;&quot;</span>)</span><br><span class="line">         user.setPhone(<span class="string">&quot;$&#123;phone&#125;$&#123;it+1&#125;&quot;</span>)</span><br><span class="line">         user.setPassword(<span class="string">&quot;$&#123;pwd&#125;$&#123;it+1&#125;&quot;</span>)</span><br><span class="line">         user.setIdCard(<span class="string">&quot;$&#123;idCard&#125;$&#123;it+1&#125;&quot;</span>)</span><br><span class="line">         users.add(user)</span><br><span class="line">      &#125;</span><br><span class="line">      userService.saveBatch(users)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&#x27;select count(*) from userinfo&#x27;</span>, Integer) == <span class="number">3</span></span><br><span class="line">      <span class="comment">// sm4hex handler</span></span><br><span class="line">      <span class="keyword">assert</span> users.get(<span class="number">0</span>).getIdCard() != idCard</span><br><span class="line">      <span class="keyword">assert</span> users.get(<span class="number">0</span>).getIdCard().length() == getSm4HexLen(idCard)</span><br><span class="line">      <span class="comment">// abb handler</span></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForList(<span class="string">&#x27;select phone from userinfo&#x27;</span>, String) == [<span class="string">&quot;$&#123;phone&#125;1&quot;</span>, <span class="string">&quot;$&#123;phone&#125;2&quot;</span>, <span class="string">&quot;$&#123;phone&#125;3&quot;</span>]</span><br><span class="line">      <span class="keyword">assert</span> users.get(<span class="number">0</span>).getPhone() == <span class="string">&quot;$&#123;phone&#125;1&quot;</span></span><br><span class="line">      <span class="comment">// sm4hex handler</span></span><br><span class="line">      <span class="keyword">def</span> queriedIdCard = jdbcTemplate.queryForObject(<span class="string">&quot;select id_card from userinfo where user_name=&#x27;$&#123;name&#125;2&#x27;&quot;</span>, String)</span><br><span class="line">      <span class="keyword">assert</span> queriedIdCard != <span class="string">&quot;$&#123;idCard&#125;2&quot;</span></span><br><span class="line">      <span class="keyword">assert</span> queriedIdCard.length() == getSm4HexLen(<span class="string">&quot;$&#123;idCard&#125;2&quot;</span>)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testBatchRetrieve() &#123;</span><br><span class="line">      List&lt;UserDO&gt; retrievedUsers = userService.list()</span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers.size() == <span class="number">3</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">0</span>].getPhone() == <span class="string">&#x27;1234****9011&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">1</span>].getPhone() == <span class="string">&#x27;1234****9012&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">2</span>].getPhone() == <span class="string">&#x27;1234****9013&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">0</span>].getIdCard() == <span class="string">&quot;$&#123;idCard&#125;1&quot;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">1</span>].getIdCard() == <span class="string">&quot;$&#123;idCard&#125;2&quot;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">2</span>].getIdCard() == <span class="string">&quot;$&#123;idCard&#125;3&quot;</span></span><br><span class="line">      <span class="keyword">return</span> retrievedUsers</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> testBatchUpdate(List&lt;UserDO&gt; retrievedUsers) &#123;</span><br><span class="line">      List&lt;UserDO&gt; usersToUpdate = <span class="keyword">new</span> ArrayList&lt;UserDO&gt;()</span><br><span class="line">      <span class="keyword">for</span> (UserDO <span class="attr">user :</span> retrievedUsers) &#123;</span><br><span class="line">         user.setPhone(phone.reverse())</span><br><span class="line">         user.setIdCard(idCard.reverse())</span><br><span class="line">         usersToUpdate.add(user)</span><br><span class="line">      &#125;</span><br><span class="line">      userService.updateBatchById(usersToUpdate)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&quot;select count(*) from userinfo where phone = &#x27;$&#123;phone.reverse()&#125;&#x27;&quot;</span>, Integer) == <span class="number">3</span></span><br><span class="line">      <span class="keyword">assert</span> jdbcTemplate.queryForObject(<span class="string">&quot;select id_card from userinfo where user_name=&#x27;$&#123;name&#125;3&#x27;&quot;</span>, String).length() == getSm4HexLen(<span class="string">&quot;$&#123;idCard.reverse()&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">      QueryWrapper&lt;UserDO&gt; wrapper = <span class="keyword">new</span> QueryWrapper()</span><br><span class="line">      wrapper.eq(<span class="string">&#x27;phone&#x27;</span>, phone.reverse())</span><br><span class="line">      retrievedUsers = userService.list(wrapper)</span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers.size() == <span class="number">3</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">0</span>].getPhone() == <span class="string">&#x27;109*****321&#x27;</span></span><br><span class="line">      <span class="keyword">assert</span> retrievedUsers[<span class="number">1</span>].getIdCard() == idCard.reverse()</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®Œæ•´å®ä¾‹å¯è§<a target="_blank" rel="noopener" href="https://github.com/wyiyi/bronze">ä»“åº“</a></p>
<h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><ul>
<li>é€šè¿‡ MyBatis æ–°å¢æˆ–ä¿å­˜å®ä½“æ—¶ï¼Œä¼ å…¥çš„å®ä½“åœ¨æ–¹æ³•è°ƒç”¨åï¼Œé…ç½®ä¸ºæ•æ„Ÿæ•°æ®çš„å±æ€§ä¼šå˜æˆåº”ç”¨äº†æ•æ„Ÿå¤„ç†å™¨ <code>encrypt</code> æ–¹æ³•ä¹‹åçš„å€¼</li>
<li>é€šè¿‡ MyBatis æŸ¥è¯¢å®ä½“æ—¶ï¼Œæ£€ç´¢å‡ºçš„å®ä½“å¯¹è±¡ä¸­ï¼Œé…ç½®äº†æ•æ„Ÿæ•°æ®çš„å±æ€§ä¼šå˜æˆåº”ç”¨äº†æ•æ„Ÿå¤„ç†å™¨ <code>decrypt</code> æ–¹æ³•ä¹‹åçš„å€¼</li>
<li>ä¸é€šè¿‡ MyBatis æ“ä½œçš„æ•°æ®ï¼Œä¸ä¼šåº”ç”¨æ•æ„Ÿæ•°æ®å¤„ç†å™¨å¤„ç†æ•°æ®</li>
<li><strong>å­˜å…¥æ•°æ®åº“ä¸­çš„æ•°æ®åœ¨æ‰§è¡Œäº†æ•æ„Ÿå¤„ç†åå°†ä¸§å¤±æŒ‰ç…§å¤„ç†å‰çš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢çš„èƒ½åŠ›ï¼Œåªèƒ½æŒ‰ç…§å¤„ç†åçš„æ•°æ®è¿›è¡ŒæŸ¥è¯¢</strong></li>
</ul>
</div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>Title: </span>åŸºäº MyBatis æ‹¦æˆªå™¨æœºåˆ¶å®ç°ä¸€ä¸ªæ•æ„Ÿæ•°æ®å¤„ç†ç»„ä»¶</p><p><span>Author: </span>Amber</p><p><span>Date: </span>2024-02-01</p><p><span>Last Update: </span>2025-08-19</p><p><span>Blog Link: </span><a href="/2024/02/01/mybatis-interceptor/">https://wyiyi.github.io/amber/2024/02/01/mybatis-interceptor/</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://wyiyi.github.io/amber/2024/02/01/mybatis-interceptor/"></i></span></p><p><span>Copyright Declaration: </span>Copyright Â© 2022 Amber.</p></div><br><div class="tags"><a href="/amber/tags/Java/"><i class="fa fa-tag"></i>Java</a><a href="/amber/tags/Mybatis/"><i class="fa fa-tag"></i>Mybatis</a></div><div class="post-nav"><a class="pre" href="/amber/2024/03/01/cxy-readme/">ç¨‹åºå‘˜çš„README</a><a class="next" href="/amber/2024/01/01/maven-offline-build/">ç¦»çº¿ç¯å¢ƒä¸‹ Maven ç¼–è¯‘æ‰“åŒ…</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=1.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=1.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=1.0.0"></script><script>var gitalk = new Gitalk({
  clientID: '14ea65cf426ef8f465fb',
  clientSecret: '1a449fb0cec00ee09ae36f1f4bd2efc486d7ac8d',
  repo: 'amber',
  owner: 'Amber',
  admin: ['Amber'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://wyiyi.github.io/amber"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/amber/categories/Books/">Books</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/amber/categories/Technology/">Technology</a><span class="category-list-count">32</span></li><li class="category-list-item"><a class="category-list-link" href="/amber/categories/%E5%B0%8F%E7%A8%8B%E5%BA%8F%EF%BC%8C%E7%94%9F%E6%B4%BB/">å°ç¨‹åºï¼Œç”Ÿæ´»</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/amber/categories/%E5%B7%A5%E4%BD%9C/">å·¥ä½œ</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/amber/tags/2022/" style="font-size: 15px;">2022</a> <a href="/amber/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 15px;">å°ç¨‹åº</a> <a href="/amber/tags/2021/" style="font-size: 15px;">2021</a> <a href="/amber/tags/Postman/" style="font-size: 15px;">Postman</a> <a href="/amber/tags/Apache-Bench/" style="font-size: 15px;">Apache Bench</a> <a href="/amber/tags/Java/" style="font-size: 15px;">Java</a> <a href="/amber/tags/BigDecimal/" style="font-size: 15px;">BigDecimal</a> <a href="/amber/tags/CORS/" style="font-size: 15px;">CORS</a> <a href="/amber/tags/Maven/" style="font-size: 15px;">Maven</a> <a href="/amber/tags/Gradle/" style="font-size: 15px;">Gradle</a> <a href="/amber/tags/Wechat/" style="font-size: 15px;">Wechat</a> <a href="/amber/tags/%E5%85%AC%E4%BC%97%E5%8F%B7/" style="font-size: 15px;">å…¬ä¼—å·</a> <a href="/amber/tags/Git/" style="font-size: 15px;">Git</a> <a href="/amber/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 15px;">åå°„</a> <a href="/amber/tags/Spring/" style="font-size: 15px;">Spring</a> <a href="/amber/tags/Scheduled/" style="font-size: 15px;">Scheduled</a> <a href="/amber/tags/Books/" style="font-size: 15px;">Books</a> <a href="/amber/tags/ResponseEntity/" style="font-size: 15px;">ResponseEntity</a> <a href="/amber/tags/DB/" style="font-size: 15px;">DB</a> <a href="/amber/tags/Servlet%EF%BC%8CFilter/" style="font-size: 15px;">Servletï¼ŒFilter</a> <a href="/amber/tags/Servlet%EF%BC%8CFilter%EF%BC%8CInterceptor/" style="font-size: 15px;">Servletï¼ŒFilterï¼ŒInterceptor</a> <a href="/amber/tags/Tools/" style="font-size: 15px;">Tools</a> <a href="/amber/tags/Spring-MVC/" style="font-size: 15px;">Spring MVC</a> <a href="/amber/tags/Interceptor/" style="font-size: 15px;">Interceptor</a> <a href="/amber/tags/Go/" style="font-size: 15px;">Go</a> <a href="/amber/tags/JSON-Lines/" style="font-size: 15px;">JSON Lines</a> <a href="/amber/tags/AI/" style="font-size: 15px;">AI</a> <a href="/amber/tags/Java8/" style="font-size: 15px;">Java8</a> <a href="/amber/tags/Lambda/" style="font-size: 15px;">Lambda</a> <a href="/amber/tags/Stream/" style="font-size: 15px;">Stream</a> <a href="/amber/tags/Java%EF%BC%8CFilter/" style="font-size: 15px;">Javaï¼ŒFilter</a> <a href="/amber/tags/Mybatis-plus/" style="font-size: 15px;">Mybatis-plus</a> <a href="/amber/tags/Ngrok/" style="font-size: 15px;">Ngrok</a> <a href="/amber/tags/JS/" style="font-size: 15px;">JS</a> <a href="/amber/tags/NodeJs/" style="font-size: 15px;">NodeJs</a> <a href="/amber/tags/npm/" style="font-size: 15px;">npm</a> <a href="/amber/tags/this/" style="font-size: 15px;">this</a> <a href="/amber/tags/Java-Web/" style="font-size: 15px;">Java Web</a> <a href="/amber/tags/Thymeleaf/" style="font-size: 15px;">Thymeleaf</a> <a href="/amber/tags/Encoding/" style="font-size: 15px;">Encoding</a> <a href="/amber/tags/BOM/" style="font-size: 15px;">BOM</a> <a href="/amber/tags/Unicode/" style="font-size: 15px;">Unicode</a> <a href="/amber/tags/SQL/" style="font-size: 15px;">SQL</a> <a href="/amber/tags/Mybatis/" style="font-size: 15px;">Mybatis</a> <a href="/amber/tags/openEuler/" style="font-size: 15px;">openEuler</a> <a href="/amber/tags/Java-JDK/" style="font-size: 15px;">Java, JDK</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Recent</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/amber/2025/08/20/java8-24/">Java 8 åˆ° Java 24 æ–°ç‰¹æ€§ä¸€è§ˆ</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2025/06/20/the-pragmatic-programmer/">ç¨‹åºå‘˜ä¿®ç‚¼ä¹‹é“ï¼šé€šå‘åŠ¡å®çš„æœ€é«˜å¢ƒç•Œï¼ˆç¬¬2ç‰ˆï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2025/03/20/chat2db/">Chat2DB - AIé©±åŠ¨çš„æ•°æ®åº“ç®¡ç†å·¥å…·</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2025/02/01/boyilun/">åšå¼ˆè®ºï¼šæ¯ä¸ªäººéƒ½èƒ½æˆä¸ºå†³ç­–é«˜æ‰‹ï¼ˆã€Šäººæ°‘æ—¥æŠ¥ã€‹æ¨èï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/11/01/Scheduled/">è§£æ Spring è®¡åˆ’ä»»åŠ¡æ‰§è¡Œå¤šæ¬¡ä¹‹è°œåŠè§£å†³æ–¹æ¡ˆ</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/10/01/nonviolent/">éæš´åŠ›æ²Ÿé€š</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/09/01/Reflection/">æŒæ¡ Java åå°„æœºåˆ¶</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/08/01/ApacheBench/">æ„é€  ApacheBench å¯ç”¨çš„ postfile</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/07/01/lambda/">Java 8 In Action Lambda</a></li><li class="post-list-item"><a class="post-list-link" href="/amber/2024/06/01/the-moon-and-sixpence/">æœˆäº®ä¸å…­ä¾¿å£«</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2025 <a href="/amber/." rel="nofollow">Amber.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/amber/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/amber/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><script type="text/javascript" color="100,99,98" opacity="0.7" zIndex="-1" count="150" src="//cdn.jsdelivr.net/npm/canvas-nest.js/dist/canvas-nest.min.js"></script><script type="text/javascript" src="/js/love.js"></script><script type="text/javascript" src="/js/copycode.js" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
  });
</script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML" async></script><script type="text/javascript" src="/amber/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/amber/js/smartresize.js?v=1.0.0"></script></div></body></html>